{% load wagtailcore_tags core_tags gem_tags %}

{% if self.show_results and results %}
  {% if self.display_survey_directly %}
    {% with 'Your '|add:surveytype|add:' has been completed successfully. See results' as paragraph_text %}
    {% trans paragraph_text as headingtext %}
    {% include "patterns/basics/headings/sp_variations/heading.html" with type="subheading" htmltag="h4" title=headingtext %}
      <ul class="polls-results-list">
      {% for question, answers in results.items %}
      <label class="{{surveytypeClass}}__question">{{ question|capfirst }}</label>
        {% for answer, count in answers.items %}
        <li class="{{surveytypeClass}}-results-list__item">
          {% if self.show_results_as_percentage %}
            {{answer}}
            <div class="{{surveytypeClass}}-results-list__percent">
              <div class="{{surveytypeClass}}-results-list__percent-bar" style="width:{{ count }}%">
                <span class="choice-percentage">{{ count }}%</p>
              </div>
            </div>
          {% else %}
            <h4 class="{{surveytypeClass}}__answers-counter">
              {{answer}} -
              {{ count }} vote{{ count|pluralize }}</h4>
          {% endif %}
        </li>
        {% endfor %}
      {% endfor %}
      </ul>
    {% endwith %}

  {% else %}
      {% with 'Your '|add:surveytype|add:' has been completed successfully!' as paragraph_text %}
        {% trans paragraph_text as headingtext %}
        {% include "patterns/basics/headings/sp_variations/heading.html" with type="subheading" htmltag="h4" title=headingtext %}
      {% endwith %}
  {% endif %}
{% endif %}
