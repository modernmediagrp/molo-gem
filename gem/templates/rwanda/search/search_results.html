{% extends "base.html" %}
{% load wagtailcore_tags core_tags wagtailimages_tags gem_tags %}

{% block content %}
  {% if search_results %}
    <div class="heading">
        <h1 class="heading--micro">{% trans "Search" %}</h1>
    </div>
    <p>{{ search_results|length }} {% trans "results found for" %} "{{search_query}}".</p>
      {% include "search/search_block.html" %}
      <div class="article-teaser">
        <ul class="teaser-stacklist">
          {# Currently not being used #}
          {% get_translation page.get_parent_section as parent_section %}
          {% for page in search_results %}
            <li class="teaser-stacklist__item">
              <div class="teaser-stacklist__wrapper">
                {% if page.image %}
                  <a href="{% pageurl page.specific %}" class="article-teaser__link">
                    {% image page.image width-200 as teaser_thumbnail %}
                    <img src="{{ teaser_thumbnail.url }}" class="article-teaser__thumbnail" />
                  </a>
                {% endif %}
              </div>

              <div class="teaser-stacklist__content">
                <a href="{% pageurl article.specific %}" class="article-teaser__link">
                  {% if page.title_highlight %}
                    <h3 class="article-teaser__title article-teaser__title--highlight">
                      {{ page.title_highlight|smarttruncatechars:45|safe}}
                    </h3>
                  {% else %}
                    <h3 class="article-teaser__title">
                      {{ page.title|smarttruncatechars:45|safe}}
                    </h3>
                  {% endif %}
                </a>

                {% if page.subtitle_highlight or page.body_highlight %}
                  <p class="article-teaser__subtitle highlight-description">
                    {% if page.subtitle_highlight %}
                      {{page.subtitle_highlight|safe}}
                    {% elif page.body_highlight %}
                      {{page.body_highlight|safe}}
                    {% endif %}
                  </p>
                {% else %}
                    <p class="article-teaser__subtitle">{{page.subtitle}}</p>
                {% endif %}
                <a class="call-to-action__read-more" href="{% pageurl article.specific %}">
                  {% trans "Read more" %}
                </a>
              </div>
            </li>
          {% endfor %}
        </ul>
    </div>

    <div class="search-result pagination">
      <div class="step-links">
        {% if search_results.has_previous %}
            <a href="?p={{ search_results.previous_page_number }}&amp;q={{search_query}}" class="pagination__nav-item pagination__nav-anchor-previous">&larr;</a>
        {% endif %}
        <span class="pagination__nav-item pagination__nav-item--current">
            Page {{ search_results.number }} of {{ search_results.paginator.num_pages }}
        </span>
        {% if search_results.has_next %}
            <a href="?p={{ search_results.next_page_number }}&amp;q={{search_query}}" class="pagination__nav-item pagination__nav-anchor-next">&rarr;</a>
        {% endif %}
      </div>
    </div>

  {% else %}
    <div class="heading">
        <h1 class="heading--micro">{% trans "Search" %}</h1>
    </div>
    <div class="search">
      <p class="no-search-results">{% trans "No search results for " %} <br/> `{{ search_query }}`</p>
      <form action="{% url 'search' %}" class="search__form" novalidate>
        <input placeholder="{% trans "I am looking for" %}" name="q" type="search">
        <input type="submit" value="{% trans "Search"%}" class="call-to-action__item call-to-action__item--with-icon">
      </form>
    </div>
  {% endif %}
{% endblock %}

{% block search %}
  {% if search_results %}
      {% include "search/search_block.html" %}
  {% endif %}
{% endblock %}
