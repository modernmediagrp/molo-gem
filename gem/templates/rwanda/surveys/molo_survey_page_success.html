{% extends 'base.html' %}
{% load wagtailimages_tags %}
{% block content %}
<div class="{% if self.your_words_competition %}yourwords{% elif self.display_survey_directly %}polls{% else %}surveys{% endif %}">
  <div class="{% if self.your_words_competition %}yourwords{% elif self.display_survey_directly %}polls{% else %}surveys{% endif %}__wrapper">
    <div class="heading heading--secondary">
      <h1 class="heading__title">{% trans 'Quiz' %}</h1>
    </div>
    <div class="{% if self.your_words_competition %}yourwords{% elif self.display_survey_directly %}polls{% else %}surveys{% endif %}__inner">
      {% if self.image %}
        <aside>
          {% image self.image width-480 as tmp_photo %}
          <img src="{{ tmp_photo.url }}" alt="{{ tmp_photo.title }}" class="{% if self.your_words_competition %}yourwords{% elif self.display_survey_directly %}polls{% else %}surveys{% endif %}__image" />
        </aside>
      {% endif %}
      <section>
        <h2 class="heading__headline">{{self.title}}</h2>
        {% if self.show_results and results %}
          <h3 class="heading__subtitle">
            {% if self.your_words_competition %}
              {% with wordSetting='GCN competition' %}
                {% blocktrans %}Your {{wordSetting}} has been completed successfully. See results{% endblocktrans %}
                {% endwith %}
            {% elif self.display_survey_directly %}
              {% with wordSetting='poll' %}
                {% blocktrans %}Your {{wordSetting}} has been completed successfully. See results{% endblocktrans %}
                {% endwith %}
            {% else %}
              {% with wordSetting='survey' %}
                {% blocktrans %}Your {{wordSetting}} has been completed successfully. See results{% endblocktrans %}
              {% endwith %}
            {% endif %}
          </h3>
          <ul class="{% if self.your_words_competition %}yourwords{% elif self.display_survey_directly %}polls{% else %}surveys{% endif %}__results">
            {% for question, answers in results.items %}
              {% for answer, count in answers.items %}
              <li class="{% if self.your_words_competition %}yourwords{% elif self.display_survey_directly %}polls{% else %}surveys{% endif %}-results__item">
                <label class="{% if self.your_words_competition %}yourwords{% elif self.display_survey_directly %}polls{% else %}surveys{% endif %}__title">{{ question|capfirst }}</label>
                {% if self.show_results_as_percentage %}
                  {{answer}}
                  <div class="{% if self.your_words_competition %}yourwords{% elif self.display_survey_directly %}polls{% else %}surveys{% endif %}-results-list__percent">
                    <div class="{% if self.your_words_competition %}yourwords{% elif self.display_survey_directly %}polls{% else %}surveys{% endif %}-results-list__percent-bar" style="width:{{ count }}%">
                      <span class="choice-percentage">{{ count }}%</span>
                    </div>
                  </div>
                {% else %}
                  <h4 class="{% if self.your_words_competition %}yourwords{% elif self.display_survey_directly %}polls{% else %}surveys{% endif %}__answers-counter">
                    {{answer}} -
                    {{ count }} vote{{ count|pluralize }}</h4>
                {% endif %}
              </li>
              {% endfor %}
            {% endfor %}
          </ul>
        {% else %}
          {% if self.thank_you_text %}
            <h3 class="heading__subtitle">{{self.thank_you_text}}</h3>
          {% else %}
            <h3 class="heading__subtitle">
              {% if self.your_words_competition %}
                {% with wordSetting='GCN competition' %}
                  {% if self.your_words_competition %}
                    {% blocktrans %}Your {{wordSetting}} has been completed successfully!{% endblocktrans %}
                  {% else %}
                    {% blocktrans %}Thank you for submitting this {{wordSetting}}!{% endblocktrans %}
                  {% endif %}
                {% endwith %}
              {% elif self.display_survey_directly %}
                {% with wordSetting='poll' %}
                  {% if self.your_words_competition %}
                    {% blocktrans %}Your {{wordSetting}} has been completed successfully!{% endblocktrans %}
                  {% else %}
                    {% blocktrans %}Thank you for submitting this {{wordSetting}}!{% endblocktrans %}
                  {% endif %}
                {% endwith %}
              {% else %}
                {% with wordSetting='survey' %}
                  {% if self.your_words_competition %}
                    {% blocktrans %}Your {{wordSetting}} has been completed successfully!{% endblocktrans %}
                  {% else %}
                    {% blocktrans %}Thank you for submitting this {{wordSetting}}!{% endblocktrans %}
                  {% endif %}
                {% endwith %}
              {% endif %}
            </h3>
          {% endif %}
        {% endif %}
        <nav>
          <a href="{{request.site.root_page.specific.url}}" class="call-to-action__button call-to-action__button--previous">
            {% trans "Back home" %}
          </a>
        </nav>
      </section>
    </div>
  </div>
</div>
{% endblock %}
